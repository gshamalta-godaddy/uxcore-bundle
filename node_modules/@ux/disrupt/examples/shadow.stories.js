/* eslint-disable no-console */
import Disrupt from '../src';
import React from 'react';
import ReactDOM from 'react-dom';

function collectStyles() {
  return [...document.head.getElementsByTagName('style')]
    .map(({ textContent }) => textContent)
    .filter(Boolean)
    .join('');
}

function getShadowHost(id) {
  let host = document.getElementById(id);
  if (document.getElementById(id)) return host;
  host = document.createElement('div');
  host.id = id;
  host.style.height = '100vh';
  host.attachShadow({ mode: 'open' });
  document.body.appendChild(host);
  return host;
}

export default function Shadow() {
  const host = getShadowHost('shadow-host');

  const content = (
    <>
      <style type='text/css'>{ collectStyles() }</style>
      <Disrupt portalElem={ host.shadowRoot } onClose={ () => console.log('onClose') }>
        <section className='content'>
          Very important message that you cannot escape from. Check the console for events.
        </section>
      </Disrupt>
    </>
  );

  ReactDOM.render(
    ReactDOM.createPortal(
      content,
      host.shadowRoot
    ),
    host
  );

  return null;
}


