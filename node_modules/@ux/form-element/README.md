# form-element

## NOTE: This is the legacy `@ux/form-element`. This component has is depreacted and it is recommend using our new [form components](https://uxcore.uxp.gdcorp.tools/docs/help/upgrade-guides/2102#new-form-elements)


The `form-element` component is the core layer of all input elements. It
provides features that are needed to correctly display inputs in various of
layouts.

## Installation

The module is released in our private npm registry under the `@ux` scope and can
be installed by running:

```
npm install @ux/form-element
```

> To develop locally for this module use `@storybook/react` and `@exemplar/storybook-react`:
> ```
> npm run storybook
> ```

## Usage

The module houses different components, of which the most important are `Fieldset`
and the actual `form-element` component. Both can be imported as:

```js
import Element, { Fieldset } from '@ux/form-element';
```

### Migration to v2002

Here is a list of key changes when migrating to 2002:

- Groups of checkboxes/radio buttons have new markup within, this was to better align with @ux/button changes and to reduce the css
- Groups of checkboxes/radio buttons no longer use the `grid` property
- Groups of checkboxes/radio buttons no longer are affected by `has-danger` class as there is no pattern with Design Foundations to describe this.
- If you wish to use the default button for these groups, use `design='button'` or a new button `design` option.
- Styles that have nothing to do with the components provided from this package have been removed from the CSS. If you are relying on CSS within this component to style other elements on the page, you'll need to either use the components we provide or add your own styling.
- New prop called `controls` can now allow app-makers to add controls to the top right of the form element in the place of `button` and `navigation`. This is to remove confusion about how `button` and `navigation` work with other supplied props.
- Removed `action` prop, `button` can accept a button component which you can add any listeners to.
- Supplying `href` may apply to either `button` or `navigation` if supplied however, it is recommended to just add your components into `controls`.

This package is planned to be deprecated with a new component to replace it. Changes above were done in order to prepare for this and to cover the incoming work for themes.

### `@ux/checkbox` and `@ux/radio`

Changes are made in v2101 which include these components are included in this package. Changes are incoming to the `@ux/checkbox` and `@ux/radio`. If you wish to use the original components prior to v2101, you may use the following import.

```js
import Checkbox from '@ux/form-element/checkbox';
import Radio from '@ux/form-element/radio';
```

## Element

Element is the component that renders the input element.

#### Properties

The component can be manipulated using the following properties:

- `id` An optional unique id attribute for the element, if none is provided it
  will transform the `label` property in usable id.
- `hideLabel` An optional attribute that defaults to false but if true, will hide
  the label while allowing the screen reader to announce the label.
- `label` The text that needs to be inside the element, a clear description of
  what the field represents.
- `size` Optional string, either `large` or `small`, that corresponds to a large/small height and font size of the input field. The default sizes will display if no string is given
- `required` Optional boolean or string which indicates that an input is required. If a string is provided it is used as the textual i18n error to display; otherwise no textual error is displayed if an input value is not provided.
- `clearable` Adds a small clickable clear button on the element to allow users to easily erase the value from the input.
- `button` This indicates that a button has to be rendered on the right side of
  the label which you can use to hide/show things for a given element. This does
  require the `action` property to also be supplied.
- `navigation` optional secondary form element button to be used in
  conjunction with `button`. If `href` is provided it will be set on
  `navigation` instead of `button` if both are provided. If any `action` is
  provided it will be used on `button` or ignored if no `button` is supplied.
- `controls` Allows for controls to be added to the top-right of the form element in the place of `button` and `navigation`.
- `type` The type of input element that needs to be rendered. If nothing is
  provided, the default `text` type is used instead.
- `name` The name of the input element, so you know under what name your value
  will be submitted.
- `value` or `defaultValue` The value for input element.
- `className` Additional classNames that should be rendered on the `input`
  element.
- `notice` Optional small text that needs to be added at the bottom of the input
  element. Can be used for hints.
- `proxy` Do not render the element in a fieldset but use an empty div instead.
- `readOnly` Prevent the user from changing the value of the `input`.
- `onChange` A change handler triggered whenever the `input` value changes.
- `onBlur` A change handler triggered whenever the component blurs (is deselected).
- `onValidChange` Callback for validity changes. See "Validation".
- `validate` A function that returns a boolean as indication for invalid or
  valid state of the input element. It receives the value as first argument.
  _Note: use this when state is internal to the element, e.g. `value` or `onChange` should not be passed in as property_.
- `validates` A boolean that indicates if the input is valid or invalid. Overrides the `validate` function.
  _Note: Use this when the output of `validate` is the result of higher order properties that are passed in_.
- `failure` A string to use as an error message under the input element for invalid input.
- `grid` An object with classNames if you want to render the input elements in
   a specific grid. It should have a label and input property with the
   classNames as value. _Note: Provide numbers that represent the relative `flex` property in stead of
   a className for React Native._
- `href` This only works if you've also set the `button` or `navigation`
  property. Represents the `href` of the `button` (or `navigation` if
  provided). If the associated property (i.e. `button` or `navigation`)
  is a string and `href` is not provided it will default to `#`.
- `inline` Indication if the element should be rendered as inline element.
- `toggleStyle` gets passed down as `props.style` to the underlying button element if `type` is `radio` or `checkbox` and `design !== 'base'`
  _Note:_ if `toggleStyle` and `style` are both present, `toggleStyle` will be used. Must follow the shape of `button.designs`

In addition to these properties, we will spread the rest of the unknown and
supplied properties on the generated `<input>` element.

That's a lot options, they should all be supplied as property to the component.

```jsx
import React from 'react';
import Form from '@ux/form';
import Element from '@ux/form-element';
import Button from '@ux/button';

export default class Contact extends React.Component {
  render() {
    return (
      <Form>
        <Element type="email" name="email" label="Your email address" />
        <Element name="subject" label="Subject" value="Bug Report" />
        <Element name="question" label="Question" />

        <Button type="submit">
          Submit
        </Button>
      </Form>
    );
  }
}
```

When the component is rendered, it automatically maintain references to relevant
DOM elements that are returned by the component. These references are stored in
the `elements` object. The following ref's are available:

- `notice` DOM element that rendered the notice message.
- `label` The wrapping label element for the input element.
- `input` Actual button element.
- `button` The button element.

```js
this.elements.input.focus();
```

## Input validation

This component is **validation context-aware**. This means that it will notify
its parent context about validation changes whenever they occur. The validation
states are as follows:

- `null`: Validation is disabled. Occurs if:
  - No `validates` or `validate` prop was passed **and**:
    - The input is not `required`, or...
    - The input is `required` and **not** empty
- `false`: Validation failed. Occurs if:
  - `validates === false`, or...
  - The input is `required` but empty, or...
  - The `validate` function returned `false`
- `true`: Validation passed. Occurs if:
  - `validates === true`
  - The `validate` function returned `true`

See the `@ux/form` documentation for more details on validation contexts.
