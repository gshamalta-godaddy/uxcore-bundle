/* eslint-disable no-console */
import Modal from '../src';
import text from '@ux/text';
import Button from '@ux/button';
import lipsum from 'bob-ross-lipsum';
import React from 'react';
import root from 'react-shadow';

function collectStyles() {
  return Array.from(document.styleSheets)
    .map(styleSheet => {
      try {
        return Array.from(styleSheet.cssRules)
          .map(rule => rule.cssText)
          .join('');
      } catch (e) { console.error(e); }
    })
    .filter(Boolean)
    .join('');
}

export default function ShadowExample() {
  const [show, setShow] = React.useState(false);
  const title = <text.h2 text='Title of the modal' as='title'/>;
  const modal = (
    <root.div className='shadow-host'>
      <style type='text/css'>{ collectStyles() }</style>
      <Modal id='iAmBatman' title={ title } onClose={ () => setShow(false) }>
        <p>
          { lipsum(10) }
        </p>
      </Modal>
    </root.div>
  );

  return (
    <>
      <Button aria-haspopup='true' design='primary' onClick={ () => { setShow(true); } } text='Open Basic Modal with Shadow DOM'/>
      { show && modal }
    </>
  );
}
