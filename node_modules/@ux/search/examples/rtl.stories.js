import Search from '../src';
import Button from '@ux/button';
import React from 'react';

const suggestions = [
  'عمالة',
  'عمتها',
  'عمران',
  'عمرًا',
  'عملاء',
  'عملها',
  'عملیة',
  'عموما'
];

export default function RTLSuggest(args) {
  const [value, setValue] = React.useState('عمران');
  const button = <Button text='Try deleting characters' design='primary' onClick={ () => console.log(value) }/>;

  let suggestion = null;
  if (value) {
    /* Find a suggestion, case-insensitive starts with current value */
    suggestion = suggestions.find((opt) => new RegExp(`^${value}`, 'gi').test(opt));
    /* If suggestion is found, use the letters typed and replace the case */
    suggestion = suggestion && suggestion.replace(/./gi, (ch, i) => value.charAt(i) || ch);
  }

  return (
    <form role='search' dir='rtl' action=''>
      <Search
        button={ button }
        suggestion={ suggestion }
        value={ value }
        onKeyDown={ (ev) => ev.key === 'Tab' && suggestion && setValue(suggestion) }
        onChange={ setValue }
        { ...args }/>
    </form>
  );
}

RTLSuggest.args = {
  id: 'my-search',
  placeholder: ''
};
