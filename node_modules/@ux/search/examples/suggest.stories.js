import Search from '../src';
import Button from '@ux/button';
import React from 'react';

const suggestions = [
  'cantaloupe',
  'carambola',
  'cherimoya',
  'cherries',
  'clementine',
  'coconut meat',
  'cranberries',
  'custard-apple'
];

export default function Suggest(args) {
  const [value, setValue] = React.useState('');
  const button = <Button text='See result in console' design='primary' onClick={ () => console.log(value) }/>;

  let suggestion = null;
  if (value) {
    /* Find a suggestion, case-insensitive starts with current value */
    suggestion = suggestions.find((opt) => new RegExp(`^${value}`, 'gi').test(opt));
    /* If suggestion is found, use the letters typed and replace the case */
    suggestion = suggestion && suggestion.replace(/./gi, (ch, i) => value.charAt(i) || ch);
  }

  return (
    <form role='search' action=''>
      <Search
        button={ button }
        suggestion={ suggestion }
        value={ value }
        onKeyDown={ (ev) => ev.key === 'Tab' && suggestion && setValue(suggestion) }
        onChange={ setValue }
        { ...args }/>
    </form>
  );
}

Suggest.args = {
  id: 'my-search',
  placeholder: 'Fruits that start with "c"'
};
