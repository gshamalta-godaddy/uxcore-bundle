import { css } from 'linaria';
import intents from '../intents.config.js';
import { gridBreakpoints, mediaBreakpointUp, breakpointInfix } from '../mixins/breakpoints';

const spacers = {
  0: '0',
  1: `calc(${intents.ux.box.density} * 1)`,
  2: `calc(${intents.ux.box.density} * 2)`,
  3: `calc(${intents.ux.box.density} * 4)`,
  4: `calc(${intents.ux.box.density} * 6)`,
  5: `calc(${intents.ux.box.density} * 12)`
};

const spacingUtils = Object.keys(gridBreakpoints).map((breakpoint) => {
  const infix = breakpointInfix(breakpoint, gridBreakpoints);
  return `
  ${mediaBreakpointUp(breakpoint, `
    ${Object.entries({ margin: 'm', padding: 'p' }).map(([prop, abbrev]) => `
      ${Object.entries(spacers).map(([size, length]) => `
        .${abbrev}${infix}-${size} { ${prop}: ${length} !important; }
        .${abbrev}t${infix}-${size},
        .${abbrev}y${infix}-${size} {
          ${prop}-top: ${length} !important;
        }
        .${abbrev}r${infix}-${size},
        .${abbrev}x${infix}-${size} {
          ${prop}-right: ${length} !important;
        }
        .${abbrev}b${infix}-${size},
        .${abbrev}y${infix}-${size} {
          ${prop}-bottom: ${length} !important;
        }
        .${abbrev}l${infix}-${size},
        .${abbrev}x${infix}-${size} {
          ${prop}-left: ${length} !important;
        }
      `).join('')}
    `).join('')}

    /* Negative margins (e.g., where '.mb-n1' is negative version of '.mb-1') */
    ${Object.entries(spacers).map(([size, length]) => `
      ${parseInt(size, 10) > 0 ? `{
        .m${infix}-n${size} { margin: -${length} !important; }
        .mt${infix}-n${size},
        .my${infix}-n${size} {
          margin-top: -${length} !important;
        }
        .mr${infix}-n${size},
        .mx${infix}-n${size} {
          margin-right: -${length} !important;
        }
        .mb${infix}-n${size},
        .my${infix}-n${size} {
          margin-bottom: -${length} !important;
        }
        .ml${infix}-n${size},
        .mx${infix}-n${size} {
          margin-left: -${length} !important;
        }
      }` : '' }
    `).join('')}

    /* Some special margin utils */
    .m${infix}-auto { margin: auto !important; }
    .mt${infix}-auto,
    .my${infix}-auto {
      margin-top: auto !important;
    }
    .mr${infix}-auto,
    .mx${infix}-auto {
      margin-right: auto !important;
    }
    .mb${infix}-auto,
    .my${infix}-auto {
      margin-bottom: auto !important;
    }
    .ml${infix}-auto,
    .mx${infix}-auto {
      margin-left: auto !important;
    }
  `)}
`;
}).join('');

export default css`
:global() {
  /* stylelint-disable declaration-colon-space-after, scss/dollar-variable-colon-space-after */
  /* Margin and Padding */

  /* TODO: This will need to be investigated more as to whether we should update to a more recent spacing file from bootstrap. */

  .m-x-auto {
    margin-right: auto !important;
    margin-left:  auto !important;
  }

  /* New spacing utilities {property}{size}-{1,2,3,4, or 5} */
  /* Exactly inline with bootstrap. */
  /* https://getbootstrap.com/docs/4.3/utilities/spacing/ */

  /* Margin and Padding */

  ${spacingUtils}

  /* Positioning */

  .pos-f-t {
    position: fixed;
    top: 0;
    right: 0;
    left: 0;
    z-index: 1030;
  }
}
`;
