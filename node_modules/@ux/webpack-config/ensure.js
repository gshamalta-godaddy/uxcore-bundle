/* eslint no-undefined: 0, no-console: 0 */
const tryRequire = require('try-require');

/**
 * Helper function which ensures that a module exists and displays
 * a custom message if it fails to require.
 *
 * @param {string|Array} names Set of module names to ensure exist
 * @param {string} msg Optional error message to display
 */
module.exports = function ensureRequire(names, msg) {
  names = Array.isArray(names) ? names : [names];
  const err = `Missing module(s): [${names}]`;
  msg = msg || [
    `${err}. Run:`,
    `npm install ${names.join(' ')}`
  ].join('\n');

  const missing = names.every(name => {
    const code = tryRequire(name);
    return code === undefined;
  });

  if (missing) {
    console.error(msg);
    throw new Error(err);
  }
};
